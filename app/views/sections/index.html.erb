<h1>Sections</h1>

<table>
  <thead>
    <tr>
      <th>Section Name</th>
      <th>Course SIS ID</th>
      <th>Size</th>
      <th>SIS ID</th>
      <th>Canvas ID</th>
      <th>Term</th>
      <th>Sync?</th>
      <th>Last Sync</th>
      <th></th>
    </tr>
  </thead>

  <tbody>
    <% @sections.each do |section| %>
      <tr>
        <td><%= link_to section.name, section %></td>
        <td><%= section.course ? section.course.sis_id : nil %></td>
        <td><%= section.enrollments.count %></td>
        <td><%= section.sis_id %></td>
        <td><%= section.canvas_id && section.canvas_course_id ? link_to("#{section.canvas_id} â§‰", "#{ENV['CANVAS_PATH']}/courses/#{section.canvas_course_id}/sections/#{section.canvas_id}") : '' %></td>
        <td class="nowrap"><%= section.term %></td>
        <td><%= section.sync_grades %></td>
        <td class="nowrap"><%= section.last_sync ? "#{time_ago_in_words(section.last_sync)} ago" : 'Never' %></td>
        <td><%= link_to 'Edit', edit_section_path(section) %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<div class="links text-center">
  <% if @sections.size == @full_count %>
    <%= link_to "Show Only 50 Sections", sections_path, class: 'btn btn-outline-primary' %>
  <% else %>
    <%= link_to "See All #{@full_count} Sections", sections_path(all: true), class: 'btn btn-outline-primary' %>
  <% end %>
</div>

<br>
<%= link_to 'Sync Grades Now', sync_all_grades_path, class: 'slow btn btn-primary m-2', data: { toggle: 'tooltip'}, title: 'Look up current grades for all sections where sync: true, update them here, and post them to OnCampus.' %>
<%= link_to 'Check for Opt-Ins', sync_all_sis_assignments_path, class: 'slow btn btn-primary m-2', data: { toggle: 'tooltip'}, title: 'Look up assignments for all synced OnCampus courses, an assignment titled: "Canvas Grade" will cause it to be synced through Classroom Console.' %>
<%= link_to 'Sync Canvas Sections', sync_all_canvas_sections_path, class: 'slow btn btn-primary m-2', data: { toggle: 'tooltip'}, title: 'If a course + sections are already present in Canvas (determined by section sis_id), add their canvas_ids here.' %>
